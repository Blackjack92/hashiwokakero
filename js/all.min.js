
class Chip {
    
    constructor(connections, x, y) {
        this.connections = connections;
        this.x = x;
        this.y = y;
        this.marked = false;
    }
    
    draw() {
        var btn = document.createElement("button");
        btn.onclick = function(){
            this.marked = !this.marked;
            $(this).css('background-color', this.marked ? "green" : "gray");
        };
        
        var t = document.createTextNode(this.connections);
        btn.appendChild(t);
        return btn;
    }
}

class Connection {
    
    constructor(x_start, y_start, x_end, y_end) {
        this.x_start = x_start;
        this.y_start = y_start;
        this.x_end = x_end;
        this.y_end = y_end;
    }
    
}

class Game {
    
    constructor(x_size, y_size) {
        this.x_size = x_size;
        this.y_size = y_size;
        
        this.chips = [];
        this.connections = [];
        
        this.marked = [];
    }

    init_by_json(json) {
    }
    
    init() {
        this.chips[0] = new Chip(2, 0, 0);
        this.chips[1] = new Chip(2, 4, 0);
        this.chips[2] = new Chip(3, 0, 2);

        this.chips[3] = new Chip(5, 2, 2);
        this.chips[4] = new Chip(4, 4, 2);
        this.chips[5] = new Chip(2, 0, 4);
        
        this.chips[6] = new Chip(4, 2, 4);
    }

    get_chip(x, y) {
        for (var i = 0; i < this.chips.length; i++) {
            var chip = this.chips[i];
            if (chip.x === x && chip.y === y) {
                return chip;
            }
        }
        return undefined;
    }
    
    draw() {
        var table = document.createElement("table");
        var table_body = document.createElement("tbody");
        for (var row = 0; row < this.y_size; row++) {
            var table_row = document.createElement("tr");
            for (var col = 0; col < this.x_size; col++) {
                var table_data = document.createElement('td');
                var chip = this.get_chip(col, row);
                if (chip === undefined) {
                    table_data.appendChild(document.createTextNode("-"));
                } else {
                    table_data.appendChild(chip.draw());
                }
                    
                table_row.appendChild(table_data);
            }
            table_body.appendChild(table_row);
        }
        table.appendChild(table_body);
        return table;
    }

    is_finished() {
    }
    
}

var game = new Game(5, 5);

function init() {
    game.init();
}

function draw() {
    table = game.draw();
    $("div.game").empty();
    var test = $("div.game")[0];
    test.appendChild(table);
}
